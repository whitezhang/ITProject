{% extends 'searchtool/base.html' %}

{% load staticfiles %}

<!--Block head-->
{% block head %}
{% endblock %}

<!--Block main_content-->
{% block main_content %}
<script type="text/javascript">
	$(function () {
        var that = this;
        $("#jRate").jRate({
            rating: 3,
            strokeColor: 'black',
            startColor: 'cyan',
            endColor: 'blue',
            shape: 'TWITTER',
            opacity: 0.7,
            precision: 0,
            width: 50,
            height: 50,
            onSet: function(rating) {
                console.log("OnSet: Rating: "+rating);
                sendRates(rating);
            }
        });
	});

    function sendRates(rating) {
	    $.get('/searchtool/ratebook', {rating: rating}, function(data) {
	        $('#test').html(data);
        });
    };

    function collectBook() {
        var bookid = document.getElementById('bookid').value;
        $.get('/searchtool/collectbook', {bookid: bookid}, function() {
            $('#collected').val('True')
            $('#collected').removeClass('linkButton');
            $('#collected').addClass('StandardWord');
            document.getElementById('liked').type='text';
        });
    };

    function sendLike() {
        var bookid = document.getElementById('bookid').value;
        $.get('/searchtool/likebook', {bookid: bookid}, function() {
            $('#liked').val('True')
            $('#liked').removeClass('linkButton');
            $('#liked').addClass('StandardWord');
            document.getElementById('liked').type='text';
        });
    };

</script>
<script src="{% static 'js/jRate.js' %}" type="text/javascript"></script>

<div>
    <h4>{{ book.id }}</h4>
    <h4>{{ book.title }}</h4>
    <h4>{{ book.authors }}</h4>
    <h4>{{ book.publishedDate }}</h4>

    <!--Collect it-->
    <!--Shopping Cart-->
    {% if book.isCollected %}
    <p>Collected</p>
    {% else %}
    <form id="collectLike" method="get" action="javascript:collectBook()">
        <input id="bookid" type="hidden" name="bookid" value="{{ book.id }}"/>
        <input id="collected" type="submit" class="linkButton" name="liked" value="{{ book.isCollected }}" readonly/>
    </form>
    {% endif %}

    <!--Like It-->
    {% if book.isLiked %}
    YES!!!
    {% else %}
    <form id="sendLike" method="get" action="javascript:sendLike()">
        <input id="bookid" type="hidden" name="bookid" value="{{ book.id }}"/>
        <input id="liked" type="submit" class="linkButton" name="liked" value="{{ book.isLiked }}" readonly/>
    </form>
    {% endif %}

    <h4 id="test">2</h4>

    <div id="jRate"></div>
</div>

{% endblock %}
